<main>
  <div class="post-item">
    <% if @post.image.attached? %>
      <%= image_tag @post.image, size: "1000x500" %>
    <% else %>
      <%= video_tag rails_blob_path(@post.video), controls: true, size: "1000x500" %>
      <%#= video_tag(rails_blob_path(post.video), autoplay: :true, loop: :true, muted: :true, class: 'video-content') %>
    <% end %>
  <div>
    <div>
      <h3><%= @post.title %></h3>
      <p><%= @post.about %></p>
      <% if @player == current_player %>
        <%= link_to "投稿を削除", post_path(@post.id), method: :delete, "data-confirm" => "本当に削除しますか？" %>
      <% end %>
      <% if player_signed_in? %>
        <% if @post.favorited_by?(current_player) %>
          <p>
            <%= link_to post_favorites_path(@post), method: :delete do %>
              ♥<%= @post.favorites.count %> いいね
            <% end %>
          </p>
          <% else %>
          <p>
            <%= link_to post_favorites_path(@post), method: :post do %>
              ♡<%= @post.favorites.count %> いいね
            <% end %>
          </p>
        <% end %>
      <% end %>
      <p>コメント件数：<%= @post.post_comments.count %></p>
    <% @post.post_comments.each do |post_comment| %>
      <div class="comment-area">
        <%= post_comment.player.first_name %><%= post_comment.player.last_name %>
        <%= post_comment.comment %><br>
        <%= post_comment.created_at.strftime('%Y/%m/%d') %>
        <% if post_comment.player == current_player %>
          <%= link_to "コメントを削除", post_post_comment_path(post_comment.post, post_comment), method: :delete %>
        <% end %>
      </div>
    <% end %>
    <%= paginate @post_comments %>
      
    <% if player_signed_in? %>
      <div>
        <%= form_with model: [@post, @post_comment] do |f| %>
          <%= f.text_area :comment, rows: '5', size: "50x5", placeholder: "コメントをここに" %>
          <%= f.submit "送信する" %>
        <% end %>
      </div>
    <% end %>
    </div>
  </div>
</main>